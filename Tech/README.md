# Техническое решение
## 1. Описание архитектуры решения

Пользователь: взаимодействует с системой через мобильное или веб-приложение.

Сервер ML: обрабатывает запросы, передает данные в модель и отдает предсказания.

База данных: хранит исторические данные о бронированиях, отменах и профилях пользователей.

Модель ML: предсказывает вероятность отказа пассажира от бронирования.

API предсказаний: предоставляет результаты предсказаний для интеграции с внешними сервисами.

![Диаграмма](arhitecture.png)


### ***Языки программирования:***

- Python 3.x

### ***Фреймворки и библиотеки:***

- Torch – для создания и обучения нейросетевой модели
- Torch.nn – для работы с нейросетевыми слоями
- Torch.optim – для оптимизации параметров модели
- NumPy – для обработки массивов данных
- Pandas – для работы с табличными данными
- Matplotlib – для визуализации (при необходимости)
- Scikit-learn – для разбиения данных на обучающую и тестовую выборки, кросс-валидации

  
### ***Используемые базы данных и инфраструктура:***

- В текущей реализации данные хранятся в локальном файле dataset.txt.
- В промышленном развертывании возможно использование PostgreSQL или MongoDB для хранения исторических данных о бронированиях и отказах от билетов.
- Возможна интеграция с брокерами сообщений (например, Kafka или RabbitMQ) для оперативного обновления предсказаний модели при поступлении новых данных.


### ***Описание данных:***
#### **Датасет содержит следующие признаки:**

- total_flights – общее количество полетов пассажира
- num_cancellations – количество отмененных полетов
- time_since_booking – время с момента бронирования (в днях)
- season_cancelled – сезон (кодировка по временам года)
- cancel_label – целевая переменная (факт отмены бронирования)

#### **Источник данных:**

- Данные могут быть собраны из внутренних систем авиакомпании, API бронирования билетов.
- В данной реализации данные загружаются из текстового файла dataset.txt, что является мокированием (заглушкой) реального источника данных(сейчас там "синтетический" датасет который мы сгенерировали сами).

#### **Обработка данных:**

- Загруженные данные конвертируются в формат torch.tensor.
- Нормализация данных на текущий момент не используется, но может быть добавлена для улучшения качества предсказаний.
- Данные разделены на обучающую (80%) и тестовую (20%) выборки.
- Используется кросс-валидация (5-Fold KFold) для повышения устойчивости модели.



- Укажите используемые ML модели и как они были обучены.
  
### ***Архитектура нейросети:***
![Диаграмма](neuro_network.png)
#### Функция потерь:
- BCELoss (Binary Cross Entropy Loss), так как задача – бинарная классификация (отменит/не отменит).

$$
\text{BCELoss}(y, \hat{y}) = - \left( y \cdot \log(\hat{y}) + (1 - y) \cdot \log(1 - \hat{y}) \right)
$$



#### Оптимизатор:
- Adam с learning rate = 0.001.

$$
\text{Adam}( \theta_t ) = \theta_{t-1} - \alpha \cdot \frac{\hat{m}_t}{\sqrt{\hat{v}_t} + \epsilon}
$$

  
#### Обучение:
- Обучение проходит в 15 эпох на каждой итерации кросс-валидации.
- Валидация выполняется после каждой эпохи.
- Используется метрика точности (accuracy) для оценки качества модели.

- Оцените потенциал вашего технического решения к масштабированию.

### ***Текущие ограничения:***

- Модель обучается и выполняется локально без оптимизаций для больших объемов данных.
- Нет механизма online-обучения (т.е. модель не обновляется по мере поступления новых данных).

### ***Пути масштабирования:***

- Использование GPU (CUDA) для ускорения обучения и инференса.
- Перевод на облачные сервисы (AWS SageMaker, Google Vertex AI, Azure ML) для динамического масштабирования.
- Оптимизация модели (снижение количества параметров, квантование весов для ускорения инференса).
- Добавление online-обучения с поступающими данными для более точных прогнозов.
- Добавление новый типов прогнозов: предполагаемая цена билета, время его появления.

- В случае мокирования части функционала опишите причину мокирования и предполагаемую будущую реализацию.

### ***В текущем решении мокированы:***

- Источник данных (dataset.txt вместо реальной базы данных).
- Отсутствует реальная интеграция с системами бронирования.
- Нет взаимодействия с бизнес-логикой авиакомпании.

### ***В будущем предполагается:***
- Интеграция с API авиакомпании для загрузки данных в режиме реального времени.
- Добавление функции предсказания с учетом дополнительных факторов (например, цена билета, дни до вылета, частота отказов по конкретным маршрутам).

## 2. Инструкция по развертыванию

- Опишите перечень шагов по развертыванию вашего технического решения.
- Например, если вы работаете с облачными технологиями, то опишите их. 
- Если ваше решение разворачивается локально, то опишите какими инструментами и командами.
- Укажите необходимые аппаратные возможности для запуска решения (особенно для AI составляющей), например, наличие GPU, минимальный объем RAM и т.п.

### ***Требования к аппаратному обеспечению***
- CPU: минимум 4 ядра (Intel i5/Ryzen 5 или выше)
- RAM: минимум 8 ГБ (16 ГБ рекомендуется)
- GPU (рекомендуется): NVIDIA с поддержкой CUDA (например, RTX 2060 и выше)
- Диск: 10 ГБ свободного места

### ***Локальное развертывание***
#### 1. Установите Python и виртуальное окружение

- python3 -m venv venv
- source venv/bin/activate  # Для Linux/macOS
- venv\Scripts\activate  # Для Windows

#### 2. Установите зависимости

- pip install torch numpy pandas scikit-learn matplotlib

#### З. Запустите обучение модели

- python train.py

#### 4. Использование модели для предсказаний

- python predict.py

### ***Облачное развертывание (AWS)***

#### 1. Создайте EC2-инстанс (Ubuntu 20.04, 16 ГБ RAM, GPU-инстанс, например p2.xlarge).

#### 2. Установите зависимости:

- sudo apt update && sudo apt install -y python3-pip
- pip3 install torch numpy pandas scikit-learn matplotlib

#### 3. Скопируйте код на сервер:

- scp -i my_key.pem train.py ubuntu@your-instance-ip:/home/ubuntu/

#### 4. Запустите модель:
- python3 train.py

### ***Заключение***

- Данное решение представляет собой базовый прототип для предсказания вероятности отказа пассажира от бронирования. В перспективе оно может быть интегрировано с системами авиакомпаний, масштабировано с использованием облачных технологий и дополнено новыми функциональными возможностями.

## 3. Исходный код решения

- [Исходный код](./Neuro/Example_Neuro.ipynb)
- [Создание датасета](./Neuro/create_dataset.py)
- [Пример данных](./Neuro/datadataset.txt)

## 4. Демо-стенд

- При наличии демо-стенда укажите на него ссылку.
- При наличии авторизации подготовьте учетные данные.
